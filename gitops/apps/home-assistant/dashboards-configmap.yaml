apiVersion: v1
kind: ConfigMap
metadata:
  name: homeassistant-dashboards
data:
  uni.yaml: |
    views:
      - title: Uni
        icon: mdi:cat
        cards:
          - type: grid
            columns: 1
            square: false
            cards:
              - type: custom:mushroom-title-card
                title: Cat Monitor
                subtitle: "Location & Activity"
    
              # Current Room / Last Seen
              - type: custom:mushroom-template-card
                primary: >
                  {% set loc = states('input_text.event_image_location') %}
                  {% if loc in ['unknown', 'unavailable', ''] %}
                    Unknown
                  {% else %}
                    {{ loc | replace('_', ' ') | title }}
                  {% endif %}
                secondary: >
                   {% set ts = states('input_text.event_image_timestamp') %}
                   {% if ts not in ['unknown', 'unavailable', ''] %}
                     {% set dt = strptime(ts, '%Y%m%d_%H%M%S') %}
                     {% if dt %}
                       Last seen: {{ dt.strftime('%-I:%M %p') }}
                     {% else %}
                       Last seen: {{ ts }}
                     {% endif %}
                   {% else %}
                     Last seen: Unknown
                   {% endif %}
                icon: mdi:cat
                icon_color: >
                  {% set loc = states('input_text.event_image_location') %}
                  {% if loc == 'bedroom' %}
                    purple
                  {% elif loc == 'living_room' %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
    
              # Latest Picture
              - type: markdown
                content: >
                  {% set loc = states('input_text.event_image_location') %}
                  {% set ts = states('input_text.event_image_timestamp') %}
                  {% if loc and loc not in ['unknown', 'unavailable', ''] %}
                    ![Pet](/local/pets/{{ loc }}_{{ ts }}.jpg)
                  {% else %}
                    No pet detected recently.
                  {% endif %}
    
              # Activity Graph
              - type: history-graph
                title: "Activity (Last 24h)"
                hours_to_show: 24
                refresh_interval: 60
                entities:
                  - entity: binary_sensor.bedroom_animal
                    name: Bedroom
                  - entity: binary_sensor.living_room_animal
                    name: Living Room
    
              - type: custom:mushroom-title-card
                title: Water Fountain
                subtitle: "Status & Controls"
    
              - type: grid
                columns: 2
                square: false
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.eversweet_solo_2_filter
                    name: Filter Status
                    icon: mdi:filter
                    primary_info: state
                    secondary_info: name
                    icon_color: blue
    
                  - type: custom:mushroom-entity-card
                    entity: sensor.eversweet_solo_2_purified_water_today
                    name: Filtered Today
                    icon: mdi:water-check
                    primary_info: state
                    secondary_info: name
                    icon_color: cyan
    
                  - type: custom:mushroom-template-card
                    entity: binary_sensor.eversweet_solo_2_water_level
                    primary: Water Level
                    secondary: >
                      {% if is_state('binary_sensor.eversweet_solo_2_water_level', 'on') %}
                        Normal
                      {% else %}
                        Low
                      {% endif %}
                    icon: >
                      {% if is_state('binary_sensor.eversweet_solo_2_water_level', 'on') %}
                        mdi:water
                      {% else %}
                        mdi:water-alert
                      {% endif %}
                    icon_color: >
                      {% if is_state('binary_sensor.eversweet_solo_2_water_level', 'on') %}
                        blue
                      {% else %}
                        red
                      {% endif %}
    
                  - type: custom:mushroom-entity-card
                    entity: switch.eversweet_solo_2_power
                    name: Power
                    layout: horizontal
                    tap_action:
                      action: toggle
    
    #      - type: entities
    #        title: Advanced Settings
    #        show_header_toggle: false
    #        entities:
    #          - entity: select.eversweet_solo_2_light_brightness
    #            name: LED Brightness
    #          - entity: select.eversweet_solo_2_mode
    #            name: Operating Mode
    #          - entity: switch.eversweet_solo_2_power
    #            name: Power Switch
  room_schedule_configuration.yaml: |
    views:
      - title: Room Schedule Configuration
        path: room-schedule-configuration
        cards:
          # Global Schedule Section
          - type: entities
            title: Global Schedule Defaults
            show_header_toggle: false
            entities:
              - entity: input_datetime.global_morning_start
                name: Morning Start
              - entity: input_datetime.global_day_start
                name: Day Start
              - entity: input_datetime.global_evening_start
                name: Evening Start
              - entity: input_datetime.global_night_start
                name: Night Start
    
          # Configuration Selectors
          - type: vertical-stack
            cards:
              - type: entities
                title: Select Room & Slot
                show_header_toggle: false
                entities:
                  - entity: input_select.room_selector
                    name: Room
                  - entity: input_select.time_window_selector
                    name: Time Slot
    
              # ------------------------------------------------------
              # BEDROOM CONFIGURATION
              # ------------------------------------------------------
              
              # Bedroom Morning
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bedroom
                  - entity: input_select.time_window_selector
                    state: morning
                card:
                  type: entities
                  title: Bedroom Morning
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bedroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bedroom_morning_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bedroom_morning_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bedroom_s1_start
                        name: Morning Start Time
                    - type: section
                    - entity: input_select.bedroom_morning_scene
                      name: Scene
                    - entity: input_boolean.bedroom_morning_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bedroom_morning_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bedroom_morning
                      name: Motion Auto-Off (min)
    
              # Bedroom Day
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bedroom
                  - entity: input_select.time_window_selector
                    state: day
                card:
                  type: entities
                  title: Bedroom Day
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bedroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bedroom_day_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bedroom_day_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bedroom_s2_start
                        name: Day Start Time
                    - type: section
                    - entity: input_select.bedroom_day_scene
                      name: Scene
                    - entity: input_boolean.bedroom_day_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bedroom_day_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bedroom_day
                      name: Motion Auto-Off (min)
    
              # Bedroom Evening
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bedroom
                  - entity: input_select.time_window_selector
                    state: evening
                card:
                  type: entities
                  title: Bedroom Evening
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bedroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bedroom_evening_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bedroom_evening_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bedroom_s3_start
                        name: Evening Start Time
                    - type: section
                    - entity: input_select.bedroom_evening_scene
                      name: Scene
                    - entity: input_boolean.bedroom_evening_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bedroom_evening_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bedroom_evening
                      name: Motion Auto-Off (min)
    
              # Bedroom Night
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bedroom
                  - entity: input_select.time_window_selector
                    state: night
                card:
                  type: entities
                  title: Bedroom Night
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bedroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bedroom_night_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bedroom_night_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bedroom_s4_start
                        name: Night Start Time
                    - type: section
                    - entity: input_select.bedroom_night_scene
                      name: Scene
                    - entity: input_boolean.bedroom_night_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bedroom_night_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bedroom_night
                      name: Motion Auto-Off (min)
    
              # ------------------------------------------------------
              # BATHROOM CONFIGURATION
              # ------------------------------------------------------
    
              # Bathroom Morning
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bathroom
                  - entity: input_select.time_window_selector
                    state: morning
                card:
                  type: entities
                  title: Bathroom Morning
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bathroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bathroom_morning_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bathroom_morning_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bathroom_s1_start
                        name: Morning Start Time
                    - type: section
                    - entity: input_select.bathroom_morning_scene
                      name: Scene
                    - entity: input_boolean.bathroom_morning_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bathroom_morning_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bathroom_morning
                      name: Motion Auto-Off (min)
    
              # Bathroom Day
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bathroom
                  - entity: input_select.time_window_selector
                    state: day
                card:
                  type: entities
                  title: Bathroom Day
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bathroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bathroom_day_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bathroom_day_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bathroom_s2_start
                        name: Day Start Time
                    - type: section
                    - entity: input_select.bathroom_day_scene
                      name: Scene
                    - entity: input_boolean.bathroom_day_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bathroom_day_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bathroom_day
                      name: Motion Auto-Off (min)
    
              # Bathroom Evening
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bathroom
                  - entity: input_select.time_window_selector
                    state: evening
                card:
                  type: entities
                  title: Bathroom Evening
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bathroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bathroom_evening_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bathroom_evening_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bathroom_s3_start
                        name: Evening Start Time
                    - type: section
                    - entity: input_select.bathroom_evening_scene
                      name: Scene
                    - entity: input_boolean.bathroom_evening_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bathroom_evening_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bathroom_evening
                      name: Motion Auto-Off (min)
    
              # Bathroom Night
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: bathroom
                  - entity: input_select.time_window_selector
                    state: night
                card:
                  type: entities
                  title: Bathroom Night
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.bathroom_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.bathroom_night_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.bathroom_night_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.bathroom_s4_start
                        name: Night Start Time
                    - type: section
                    - entity: input_select.bathroom_night_scene
                      name: Scene
                    - entity: input_boolean.bathroom_night_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.bathroom_night_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_bathroom_night
                      name: Motion Auto-Off (min)
    
              # ------------------------------------------------------
              # LIVING ROOM CONFIGURATION
              # ------------------------------------------------------
    
              # Living Room Morning
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: living_room
                  - entity: input_select.time_window_selector
                    state: morning
                card:
                  type: entities
                  title: Living Room Morning
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.living_room_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.living_room_morning_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.living_room_morning_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.living_room_s1_start
                        name: Morning Start Time
                    - type: section
                    - entity: input_select.living_room_morning_scene
                      name: Scene
                    - entity: input_boolean.living_room_morning_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.living_room_morning_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_living_room_morning
                      name: Motion Auto-Off (min)
    
              # Living Room Day
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: living_room
                  - entity: input_select.time_window_selector
                    state: day
                card:
                  type: entities
                  title: Living Room Day
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.living_room_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.living_room_day_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.living_room_day_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.living_room_s2_start
                        name: Day Start Time
                    - type: section
                    - entity: input_select.living_room_day_scene
                      name: Scene
                    - entity: input_boolean.living_room_day_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.living_room_day_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_living_room_day
                      name: Motion Auto-Off (min)
    
              # Living Room Evening
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: living_room
                  - entity: input_select.time_window_selector
                    state: evening
                card:
                  type: entities
                  title: Living Room Evening
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.living_room_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.living_room_evening_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.living_room_evening_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.living_room_s3_start
                        name: Evening Start Time
                    - type: section
                    - entity: input_select.living_room_evening_scene
                      name: Scene
                    - entity: input_boolean.living_room_evening_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.living_room_evening_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_living_room_evening
                      name: Motion Auto-Off (min)
    
              # Living Room Night
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: living_room
                  - entity: input_select.time_window_selector
                    state: night
                card:
                  type: entities
                  title: Living Room Night
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.living_room_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.living_room_night_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.living_room_night_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.living_room_s4_start
                        name: Night Start Time
                    - type: section
                    - entity: input_select.living_room_night_scene
                      name: Scene
                    - entity: input_boolean.living_room_night_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.living_room_night_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_living_room_night
                      name: Motion Auto-Off (min)
    
              # ------------------------------------------------------
              # KITCHEN CONFIGURATION
              # ------------------------------------------------------
    
              # Kitchen Morning
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: kitchen
                  - entity: input_select.time_window_selector
                    state: morning
                card:
                  type: entities
                  title: Kitchen Morning
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.kitchen_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.kitchen_morning_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.kitchen_morning_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.kitchen_s1_start
                        name: Morning Start Time
                    - type: section
                    - entity: input_select.kitchen_morning_scene
                      name: Scene
                    - entity: input_boolean.kitchen_morning_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.kitchen_morning_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_kitchen_morning
                      name: Motion Auto-Off (min)
    
              # Kitchen Day
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: kitchen
                  - entity: input_select.time_window_selector
                    state: day
                card:
                  type: entities
                  title: Kitchen Day
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.kitchen_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.kitchen_day_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.kitchen_day_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.kitchen_s2_start
                        name: Day Start Time
                    - type: section
                    - entity: input_select.kitchen_day_scene
                      name: Scene
                    - entity: input_boolean.kitchen_day_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.kitchen_day_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_kitchen_day
                      name: Motion Auto-Off (min)
    
              # Kitchen Evening
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: kitchen
                  - entity: input_select.time_window_selector
                    state: evening
                card:
                  type: entities
                  title: Kitchen Evening
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.kitchen_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.kitchen_evening_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.kitchen_evening_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.kitchen_s3_start
                        name: Evening Start Time
                    - type: section
                    - entity: input_select.kitchen_evening_scene
                      name: Scene
                    - entity: input_boolean.kitchen_evening_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.kitchen_evening_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_kitchen_evening
                      name: Motion Auto-Off (min)
    
              # Kitchen Night
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: kitchen
                  - entity: input_select.time_window_selector
                    state: night
                card:
                  type: entities
                  title: Kitchen Night
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.kitchen_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.kitchen_night_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.kitchen_night_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.kitchen_s4_start
                        name: Night Start Time
                    - type: section
                    - entity: input_select.kitchen_night_scene
                      name: Scene
                    - entity: input_boolean.kitchen_night_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.kitchen_night_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_kitchen_night
                      name: Motion Auto-Off (min)
    
              # ------------------------------------------------------
              # HALLWAY CONFIGURATION
              # ------------------------------------------------------
    
              # Hallway Morning
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: hallway
                  - entity: input_select.time_window_selector
                    state: morning
                card:
                  type: entities
                  title: Hallway Morning
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.hallway_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.hallway_morning_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.hallway_morning_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.hallway_s1_start
                        name: Morning Start Time
                    - type: section
                    - entity: input_select.hallway_morning_scene
                      name: Scene
                    - entity: input_boolean.hallway_morning_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.hallway_morning_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_hallway_morning
                      name: Motion Auto-Off (min)
    
              # Hallway Day
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: hallway
                  - entity: input_select.time_window_selector
                    state: day
                card:
                  type: entities
                  title: Hallway Day
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.hallway_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.hallway_day_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.hallway_day_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.hallway_s2_start
                        name: Day Start Time
                    - type: section
                    - entity: input_select.hallway_day_scene
                      name: Scene
                    - entity: input_boolean.hallway_day_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.hallway_day_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_hallway_day
                      name: Motion Auto-Off (min)
    
              # Hallway Evening
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: hallway
                  - entity: input_select.time_window_selector
                    state: evening
                card:
                  type: entities
                  title: Hallway Evening
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.hallway_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.hallway_evening_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.hallway_evening_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.hallway_s3_start
                        name: Evening Start Time
                    - type: section
                    - entity: input_select.hallway_evening_scene
                      name: Scene
                    - entity: input_boolean.hallway_evening_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.hallway_evening_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_hallway_evening
                      name: Motion Auto-Off (min)
    
              # Hallway Night
              - type: conditional
                conditions:
                  - entity: input_select.room_selector
                    state: hallway
                  - entity: input_select.time_window_selector
                    state: night
                card:
                  type: entities
                  title: Hallway Night
                  show_header_toggle: false
                  entities:
                    - entity: input_boolean.hallway_custom_schedule
                      name: Use Custom Schedule (Room Master)
                    - entity: input_boolean.hallway_night_custom_time
                      name: Override Global Time
                    - type: conditional
                      conditions:
                        - entity: input_boolean.hallway_night_custom_time
                          state: "on"
                      row:
                        entity: input_datetime.hallway_s4_start
                        name: Night Start Time
                    - type: section
                    - entity: input_select.hallway_night_scene
                      name: Scene
                    - entity: input_boolean.hallway_night_motion_enabled
                      name: Motion Activated
                    - entity: input_boolean.hallway_night_auto_on_enabled
                      name: Auto-On
                    - entity: input_number.motion_auto_off_hallway_night
                      name: Motion Auto-Off (min)
  dean.yaml: |
    strategy:
      type: custom:mushroom-strategy
      options:
        # Hide unavailable entities and specific entity configurations
        card_options:
          # Camera cards - hide when privacy mode is enabled
          camera.bedroom_fluent:
            hidden: "{{ is_state('switch.bedroom_privacy_mode', 'on') }}"
          camera.living_room_fluent:
            hidden: "{{ is_state('switch.living_room_privacy_mode', 'on') }}"
          # Hide individual lights that duplicate single-member groups
          light.fixture:
            hidden: true
          light.bathroom_1:
            hidden: true
          light.hallway_1:
            hidden: true
          # Hide PTZ and guard buttons, sirens, and motion/animal sensors for bedroom and living room when unavailable
          # Bedroom entities
          button.bedroom_guard_go_to:
            hidden: true
          button.bedroom_ptz_down:
            hidden: true
          button.bedroom_ptz_left:
            hidden: true
          button.bedroom_ptz_right:
            hidden: true
          button.bedroom_ptz_up:
            hidden: true
          button.bedroom_ptz_stop:
            hidden: true
          siren.bedroom_siren:
            hidden: true
          binary_sensor.bedroom_animal:
            hidden: true
          binary_sensor.bedroom_motion:
            hidden: true
          binary_sensor.bedroom_baby_crying:
            hidden: true
          binary_sensor.bedroom_person:
            hidden: true
    
          # Living room entities
          button.living_room_guard_go_to:
            hidden: true
          button.living_room_ptz_down:
            hidden: true
          button.living_room_ptz_left:
            hidden: true
          button.living_room_ptz_right:
            hidden: true
          button.living_room_ptz_up:
            hidden: true
          button.living_room_ptz_stop:
            hidden: true
          siren.living_room_siren:
            hidden: true
          binary_sensor.living_room_animal:
            hidden: true
          binary_sensor.living_room_motion:
            hidden: true
          binary_sensor.living_room_baby_crying:
            hidden: true
          binary_sensor.living_room_person:
            hidden: true
    
        # Hide unavailable entities using card_options templates
        # Note: mushroom-strategy doesn't support domain-level filtering by state
        # We need to add specific entities here as they're discovered
        # Alternatively, entities can be hidden individually in card_options above
    
        # Quick access cards (between greeting and area cards)
        quick_access_cards:
          - type: conditional
            conditions:
              - entity: device_tracker.pixel_9_pro_xl
                state_not: "work"
            card:
              type: custom:auto-entities
              card:
                type: entities
                title: To Work (Atlantic Av - N/Q/D)
                icon: mdi:briefcase
                show_header_toggle: false
              filter:
                template: |
                  {% if now().weekday() < 5 %}
                  [
                    {% for state in states.sensor -%}
                      {%- if state.attributes.friendly_name is defined and ('Atlantic Av' in state.attributes.friendly_name or 'Barclays' in state.attributes.friendly_name) and state.attributes.route_id in ['N', 'Q', 'D'] and state.state not in ['unavailable', 'unknown'] -%}
                        {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                        {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                        {
                          "entity": "{{ state.entity_id }}",
                          "name": "{{ state.attributes.route_id }} to {{ headsign }}",
                          "secondary_info": "last-updated"
                        },
                        {%- endif -%}
                      {%- endif -%}
                    {%- endfor %}
                  ]
                  {% else %}
                  []
                  {% endif %}
              show_empty: false
              sort:
                method: state
                numeric: true
    
          - type: conditional
            conditions:
              - entity: device_tracker.pixel_9_pro_xl
                state: "work"
            card:
              type: custom:auto-entities
              card:
                type: entities
                title: To Home (57 St - N/Q/R/W)
                icon: mdi:home
                show_header_toggle: false
              filter:
                template: |
                  {% if now().weekday() < 5 %}
                  [
                    {% for state in states.sensor -%}
                      {%- if state.attributes.friendly_name is defined and '57 St' in state.attributes.friendly_name and state.attributes.route_id in ['N', 'Q', 'R', 'W'] and state.state not in ['unavailable', 'unknown'] -%}
                        {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                        {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                        {
                          "entity": "{{ state.entity_id }}",
                          "name": "{{ state.attributes.route_id }} to {{ headsign }}",
                          "secondary_info": "last-updated"
                        },
                        {%- endif -%}
                      {%- endif -%}
                    {%- endfor %}
                  ]
                  {% else %}
                  []
                  {% endif %}
              show_empty: false
              sort:
                method: state
                numeric: true
    
    
        # Extra cards (below area cards)
        extra_cards:
          - type: custom:mushroom-title-card
            title: Home Scene Control
          # Scene Control Card - Toggle home lights and activate scenes for all rooms
          - type: grid
            square: true
            columns: 3
            cards:
              # Toggle home lights button - icon only
              - type: button
                entity: light.home
                show_name: false
                icon: mdi:lightbulb
                tap_action:
                  action: toggle
                show_state: false
              # Morning scene button - icon only
              - type: button
                show_name: false
                icon: mdi:weather-sunset-up
                tap_action:
                  action: call-service
                  service: script.activate_all_room_scenes
                  service_data:
                    slot: morning
              # Day scene button - icon only
              - type: button
                show_name: false
                icon: mdi:weather-sunny
                tap_action:
                  action: call-service
                  service: script.activate_all_room_scenes
                  service_data:
                    slot: day
              # Evening scene button - icon only
              - type: button
                show_name: false
                icon: mdi:weather-sunset-down
                tap_action:
                  action: call-service
                  service: script.activate_all_room_scenes
                  service_data:
                    slot: evening
              # Night scene button - icon only
              - type: button
                show_name: false
                icon: mdi:weather-night
                tap_action:
                  action: call-service
                  service: script.activate_all_room_scenes
                  service_data:
                    slot: night
              # Movie scene button - icon only
              - type: button
                show_name: false
                icon: mdi:movie-open
                tap_action:
                  action: call-service
                  service: scene.turn_on
                target:
                  entity_id: scene.home_movie
    
          - type: custom:mushroom-title-card
            title: Latest Pet Detection
          - type: conditional
            conditions:
              - entity: input_text.event_image_location
                state_not: ""
              - entity: input_text.event_image_location
                state_not: "unknown"
            card:
              type: markdown
              content: >
                {% set loc = states('input_text.event_image_location') %}
                {% set ts = states('input_text.event_image_timestamp') %}
                ![Pet](/local/pets/{{ loc }}_{{ ts }}.jpg)
    
        # Area configuration
        areas:
          living_room:
            name: Living Room
            icon: mdi:sofa
            icon_color: blue
            order: 1
            extra_cards:
              - type: custom:auto-entities
                show_empty: false
                card:
                  type: entities
                  title: Camera Controls
                  show_header_toggle: false
                filter:
                  include:
                    - entity_id: button.living_room_guard_go_to
                    - entity_id: button.living_room_ptz_down
                    - entity_id: button.living_room_ptz_left
                    - entity_id: button.living_room_ptz_right
                    - entity_id: button.living_room_ptz_up
                    - entity_id: button.living_room_ptz_stop
                    - entity_id: siren.living_room_siren
                    - entity_id: binary_sensor.living_room_animal
                    - entity_id: binary_sensor.living_room_motion
                    - entity_id: binary_sensor.living_room_baby_crying
                    - entity_id: binary_sensor.living_room_person
                  exclude:
                    - state: "unavailable"
                    - state: "unknown"
          kitchen:
            name: Kitchen
            icon: mdi:silverware-fork-knife
            icon_color: orange
            order: 2
          bathroom:
            name: Bathroom
            icon: mdi:shower
            icon_color: cyan
            order: 3
          bedroom:
            name: Bedroom
            icon: mdi:bed
            icon_color: purple
            order: 4
            extra_cards:
              - type: custom:auto-entities
                show_empty: false
                card:
                  type: entities
                  title: Camera Controls
                  show_header_toggle: false
                filter:
                  include:
                    - entity_id: button.bedroom_guard_go_to
                    - entity_id: button.bedroom_ptz_down
                    - entity_id: button.bedroom_ptz_left
                    - entity_id: button.bedroom_ptz_right
                    - entity_id: button.bedroom_ptz_up
                    - entity_id: button.bedroom_ptz_stop
                    - entity_id: siren.bedroom_siren
                    - entity_id: binary_sensor.bedroom_animal
                    - entity_id: binary_sensor.bedroom_motion
                    - entity_id: binary_sensor.bedroom_baby_crying
                    - entity_id: binary_sensor.bedroom_person
                  exclude:
                    - state: "unavailable"
                    - state: "unknown"
          hallway:
            name: Hallway
            icon: mdi:door-open
            icon_color: amber
            order: 5
          # Hide the 'home' area card, but keep the main dashboard view
          home:
            hidden: true
    
        # View customizations
        views:
          # Customize default view
          home:
            title: Home
            icon: mdi:home
            path: home
          # Ensure switch view is visible
          switch:
            hidden: false
    
    
  room_schedule_viewer.yaml: |
    views:
      - title: Room Schedule Viewer
        path: room-schedule-viewer
        cards:
          - type: vertical-stack
            cards:
              # Room selector dropdown
              - type: entities
                title: Select Room
                entities:
                  - entity: input_select.room_selector
                    name: Room
    
          # Active Scene Status Card
          - type: markdown
            title: Current Status
            content: |
              {% set room = states('input_select.room_selector') %}
              {% if room and room != 'unknown' and room != 'unavailable' %}
                {% set morning_custom = states('input_boolean.' ~ room ~ '_morning_custom_time') %}
                {% set day_custom = states('input_boolean.' ~ room ~ '_day_custom_time') %}
                {% set evening_custom = states('input_boolean.' ~ room ~ '_evening_custom_time') %}
                {% set night_custom = states('input_boolean.' ~ room ~ '_night_custom_time') %}
                {% set s1 = states('input_datetime.' ~ room ~ '_s1_start') if morning_custom == 'on' else '06:00:00' %}
                {% set s2 = states('input_datetime.' ~ room ~ '_s2_start') if day_custom == 'on' else '09:00:00' %}
                {% set s3 = states('input_datetime.' ~ room ~ '_s3_start') if evening_custom == 'on' else '17:00:00' %}
                {% set s4 = states('input_datetime.' ~ room ~ '_s4_start') if night_custom == 'on' else '22:00:00' %}
                {% set now_ts = as_timestamp(now()) %}
                {% set s1_ts = as_timestamp(today_at(s1)) %}
                {% set s2_ts = as_timestamp(today_at(s2)) %}
                {% set s3_ts = as_timestamp(today_at(s3)) %}
                {% set s4_ts = as_timestamp(today_at(s4)) %}
                {% if now_ts >= s1_ts and now_ts < s2_ts %}
                  {% set scheduled_slot = 'morning' %}
                  {% set next_transition = s2[:5] %}
                  {% set next_slot = 'day' %}
                {% elif now_ts >= s2_ts and now_ts < s3_ts %}
                  {% set scheduled_slot = 'day' %}
                  {% set next_transition = s3[:5] %}
                  {% set next_slot = 'evening' %}
                {% elif now_ts >= s3_ts and now_ts < s4_ts %}
                  {% set scheduled_slot = 'evening' %}
                  {% set next_transition = s4[:5] %}
                  {% set next_slot = 'night' %}
                {% else %}
                  {% set scheduled_slot = 'night' %}
                  {% set next_transition = s1[:5] %}
                  {% set next_slot = 'morning' %}
                {% endif %}
                {% set scene_cycle_helper = 'input_select.' ~ room ~ '_scene_cycle' %}
                {% set scene_cycle = states(scene_cycle_helper) %}
                {% if scene_cycle and scene_cycle != 'unknown' and scene_cycle != 'unavailable' and scene_cycle in ['morning', 'day', 'evening', 'night'] %}
                  {% if scene_cycle != scheduled_slot %}
                    {% set current_slot = scene_cycle %}
                    {% set is_manual_override = true %}
                  {% else %}
                    {% set current_slot = scheduled_slot %}
                    {% set is_manual_override = false %}
                  {% endif %}
                {% else %}
                  {% set current_slot = scheduled_slot %}
                  {% set is_manual_override = false %}
                {% endif %}
                
                ### **{{ current_slot|title }} Scene Active**
                
                {% if is_manual_override %}
                  *Manual override active*
                {% else %}
                  *Scheduled scene*
                {% endif %}
                
                Next transition: **{{ next_transition }}**  {{ next_slot|title }}
              {% else %}
                Please select a room above.
              {% endif %}
    
          # Manual Scene Control Buttons - Conditional cards per room
          - type: conditional
            conditions:
              - entity: input_select.room_selector
                state: bathroom
            card:
              type: horizontal-stack
              cards:
                    - type: button
                      name: Morning
                      icon: mdi:weather-sunset-up
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bathroom_morning
                          helper_entity: input_select.bathroom_scene_cycle
                          slot_name: morning
                      show_state: false
                    - type: button
                      name: Day
                      icon: mdi:weather-sunny
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bathroom_day
                          helper_entity: input_select.bathroom_scene_cycle
                          slot_name: day
                      show_state: false
                    - type: button
                      name: Evening
                      icon: mdi:weather-sunset-down
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bathroom_evening
                          helper_entity: input_select.bathroom_scene_cycle
                          slot_name: evening
                      show_state: false
                    - type: button
                      name: Night
                      icon: mdi:weather-night
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bathroom_night
                          helper_entity: input_select.bathroom_scene_cycle
                          slot_name: night
                      show_state: false
    
          - type: conditional
            conditions:
              - entity: input_select.room_selector
                state: bedroom
            card:
              type: horizontal-stack
              cards:
                    - type: button
                      name: Morning
                      icon: mdi:weather-sunset-up
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bedroom_morning
                          helper_entity: input_select.bedroom_scene_cycle
                          slot_name: morning
                      show_state: false
                    - type: button
                      name: Day
                      icon: mdi:weather-sunny
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bedroom_day
                          helper_entity: input_select.bedroom_scene_cycle
                          slot_name: day
                      show_state: false
                    - type: button
                      name: Evening
                      icon: mdi:weather-sunset-down
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bedroom_evening
                          helper_entity: input_select.bedroom_scene_cycle
                          slot_name: evening
                      show_state: false
                    - type: button
                      name: Night
                      icon: mdi:weather-night
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.bedroom_night
                          helper_entity: input_select.bedroom_scene_cycle
                          slot_name: night
                      show_state: false
    
          - type: conditional
            conditions:
              - entity: input_select.room_selector
                state: hallway
            card:
              type: horizontal-stack
              cards:
                    - type: button
                      name: Morning
                      icon: mdi:weather-sunset-up
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.hallway_morning
                          helper_entity: input_select.hallway_scene_cycle
                          slot_name: morning
                      show_state: false
                    - type: button
                      name: Day
                      icon: mdi:weather-sunny
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.hallway_day
                          helper_entity: input_select.hallway_scene_cycle
                          slot_name: day
                      show_state: false
                    - type: button
                      name: Evening
                      icon: mdi:weather-sunset-down
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.hallway_evening
                          helper_entity: input_select.hallway_scene_cycle
                          slot_name: evening
                      show_state: false
                    - type: button
                      name: Night
                      icon: mdi:weather-night
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.hallway_night
                          helper_entity: input_select.hallway_scene_cycle
                          slot_name: night
                      show_state: false
    
          - type: conditional
            conditions:
              - entity: input_select.room_selector
                state: kitchen
            card:
              type: horizontal-stack
              cards:
                    - type: button
                      name: Morning
                      icon: mdi:weather-sunset-up
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.kitchen_morning
                          helper_entity: input_select.kitchen_scene_cycle
                          slot_name: morning
                      show_state: false
                    - type: button
                      name: Day
                      icon: mdi:weather-sunny
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.kitchen_day
                          helper_entity: input_select.kitchen_scene_cycle
                          slot_name: day
                      show_state: false
                    - type: button
                      name: Evening
                      icon: mdi:weather-sunset-down
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.kitchen_evening
                          helper_entity: input_select.kitchen_scene_cycle
                          slot_name: evening
                      show_state: false
                    - type: button
                      name: Night
                      icon: mdi:weather-night
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.kitchen_night
                          helper_entity: input_select.kitchen_scene_cycle
                          slot_name: night
                      show_state: false
    
          - type: conditional
            conditions:
              - entity: input_select.room_selector
                state: living_room
            card:
              type: horizontal-stack
              cards:
                    - type: button
                      name: Morning
                      icon: mdi:weather-sunset-up
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.living_room_morning
                          helper_entity: input_select.living_room_scene_cycle
                          slot_name: morning
                      show_state: false
                    - type: button
                      name: Day
                      icon: mdi:weather-sunny
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.living_room_day
                          helper_entity: input_select.living_room_scene_cycle
                          slot_name: day
                      show_state: false
                    - type: button
                      name: Evening
                      icon: mdi:weather-sunset-down
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.living_room_evening
                          helper_entity: input_select.living_room_scene_cycle
                          slot_name: evening
                      show_state: false
                    - type: button
                      name: Night
                      icon: mdi:weather-night
                      tap_action:
                        action: call-service
                        service: script.activate_scene_with_helper
                        service_data:
                          scene_entity: scene.living_room_night
                          helper_entity: input_select.living_room_scene_cycle
                          slot_name: night
                      show_state: false
    
          # Schedule Display
          - type: markdown
            title: Schedule
            content: |
              {% set room = states('input_select.room_selector') %}
              {% if room and room != 'unknown' and room != 'unavailable' %}
                {% set morning_custom = states('input_boolean.' ~ room ~ '_morning_custom_time') %}
                {% set day_custom = states('input_boolean.' ~ room ~ '_day_custom_time') %}
                {% set evening_custom = states('input_boolean.' ~ room ~ '_evening_custom_time') %}
                {% set night_custom = states('input_boolean.' ~ room ~ '_night_custom_time') %}
                {% if morning_custom == 'on' %}
                  {% set s1_raw = states('input_datetime.' ~ room ~ '_s1_start') %}
                  {% set s1 = s1_raw.split(' ')[-1][:5] if ' ' in s1_raw else (s1_raw[:5] if s1_raw|length >= 5 else '06:00') %}
                {% else %}
                  {% set s1 = '06:00' %}
                {% endif %}
                {% if day_custom == 'on' %}
                  {% set s2_raw = states('input_datetime.' ~ room ~ '_s2_start') %}
                  {% set s2 = s2_raw.split(' ')[-1][:5] if ' ' in s2_raw else (s2_raw[:5] if s2_raw|length >= 5 else '09:00') %}
                {% else %}
                  {% set s2 = '09:00' %}
                {% endif %}
                {% if evening_custom == 'on' %}
                  {% set s3_raw = states('input_datetime.' ~ room ~ '_s3_start') %}
                  {% set s3 = s3_raw.split(' ')[-1][:5] if ' ' in s3_raw else (s3_raw[:5] if s3_raw|length >= 5 else '17:00') %}
                {% else %}
                  {% set s3 = '17:00' %}
                {% endif %}
                {% if night_custom == 'on' %}
                  {% set s4_raw = states('input_datetime.' ~ room ~ '_s4_start') %}
                  {% set s4 = s4_raw.split(' ')[-1][:5] if ' ' in s4_raw else (s4_raw[:5] if s4_raw|length >= 5 else '22:00') %}
                {% else %}
                  {% set s4 = '22:00' %}
                {% endif %}
                
                {% set morning_override = states('input_select.' ~ room ~ '_morning_scene') %}
                {% set day_override = states('input_select.' ~ room ~ '_day_scene') %}
                {% set evening_override = states('input_select.' ~ room ~ '_evening_scene') %}
                {% set night_override = states('input_select.' ~ room ~ '_night_scene') %}
                
                {% set morning_scene = morning_override if morning_override not in ['unknown', 'unavailable', ''] else 'scene.' ~ room ~ '_morning' %}
                {% set day_scene = day_override if day_override not in ['unknown', 'unavailable', ''] else 'scene.' ~ room ~ '_day' %}
                {% set evening_scene = evening_override if evening_override not in ['unknown', 'unavailable', ''] else 'scene.' ~ room ~ '_evening' %}
                {% set night_scene = night_override if night_override not in ['unknown', 'unavailable', ''] else 'scene.' ~ room ~ '_night' %}
                
                {% set morning_enabled = states('input_boolean.enable_' ~ room ~ '_morning') %}
                {% set day_enabled = states('input_boolean.enable_' ~ room ~ '_day') %}
                {% set evening_enabled = states('input_boolean.enable_' ~ room ~ '_evening') %}
                {% set night_enabled = states('input_boolean.enable_' ~ room ~ '_night') %}
                
                {% set morning_auto_on = states('input_boolean.auto_on_' ~ room ~ '_morning') %}
                {% set day_auto_on = states('input_boolean.auto_on_' ~ room ~ '_day') %}
                {% set evening_auto_on = states('input_boolean.auto_on_' ~ room ~ '_evening') %}
                {% set night_auto_on = states('input_boolean.auto_on_' ~ room ~ '_night') %}
                
                {% set morning_motion = states('input_boolean.motion_activated_' ~ room ~ '_morning') %}
                {% set day_motion = states('input_boolean.motion_activated_' ~ room ~ '_day') %}
                {% set evening_motion = states('input_boolean.motion_activated_' ~ room ~ '_evening') %}
                {% set night_motion = states('input_boolean.motion_activated_' ~ room ~ '_night') %}
                
                | Time Slot | Scene | Activation Time | Timer Enabled | Auto-On | Motion Activated |
                |-----------|-------|----------------|---------------|---------|------------------|
                | Morning | `{{ morning_scene }}` | {{ s1 }} | {% if morning_enabled == 'on' %}{% else %}{% endif %} | {% if morning_auto_on == 'on' %}{% else %}{% endif %} | {% if morning_motion == 'on' %}{% else %}{% endif %} |
                | Day | `{{ day_scene }}` | {{ s2 }} | {% if day_enabled == 'on' %}{% else %}{% endif %} | {% if day_auto_on == 'on' %}{% else %}{% endif %} | {% if day_motion == 'on' %}{% else %}{% endif %} |
                | Evening | `{{ evening_scene }}` | {{ s3 }} | {% if evening_enabled == 'on' %}{% else %}{% endif %} | {% if evening_auto_on == 'on' %}{% else %}{% endif %} | {% if evening_motion == 'on' %}{% else %}{% endif %} |
                | Night | `{{ night_scene }}` | {{ s4 }} | {% if night_enabled == 'on' %}{% else %}{% endif %} | {% if night_auto_on == 'on' %}{% else %}{% endif %} | {% if night_motion == 'on' %}{% else %}{% endif %} |
                
                {% set any_custom = morning_custom == 'on' or day_custom == 'on' or evening_custom == 'on' or night_custom == 'on' %}
                {% if any_custom %}
                  *Custom schedule enabled*
                {% else %}
                  *Default schedule (06:00, 09:00, 17:00, 22:00)*
                {% endif %}
              {% else %}
                Please select a room above.
              {% endif %}
    
  security.yaml: |
    views:
      - title: Home
        sections:
          - type: grid
            cards:
              - type: heading
                heading: Camera Controls
                heading_style: title
                icon: mdi:camera-lock
              - type: entities
                entities:
                  - switch.bedroom_privacy_mode
                  - switch.living_room_privacy_mode
          - type: grid
            cards:
              - type: heading
                heading: Camera Feeds
                heading_style: title
                icon: mdi:camera
              - type: grid
                square: false
                columns: 1
                cards:
                  - type: picture-entity
                    entity: camera.bedroom_fluent
                  - type: picture-entity
                    entity: camera.living_room_fluent
    
          - type: grid
            cards:
              - type: heading
                heading: Latest Human Detection
                heading_style: title
                icon: mdi:account-alert
              - type: markdown
                content: >
                  {% set loc = states('input_text.intruder_image_location') %}
                  {% set ts = states('input_text.intruder_image_timestamp') %}
                  {% if loc and loc not in ['unknown', 'unavailable', ''] %}
                    ![Intruder](/local/intruders/{{ loc }}_{{ ts }}.jpg)
                    
                    **Location:** {{ loc | replace('_', ' ') | title }}
                    **Time:** {{ strptime(ts, '%Y%m%d_%H%M%S').strftime('%-I:%M %p on %b %d') if ts and ts not in ['unknown', 'unavailable'] else 'Unknown' }}
                  {% else %}
                    No intruder detected.
                  {% endif %}
    
          - type: grid
            cards:
              - type: heading
                heading: Events
                heading_style: title
                icon: mdi:walk
              - type: entities
                entities:
                  - binary_sensor.bedroom_animal
                  - binary_sensor.living_room_animal
              - type: entities
                entities:
                  - binary_sensor.bedroom_person
                  - binary_sensor.living_room_person
        header:
          card:
            type: markdown
            text_only: true
            content: '# Security'
  subway.yaml: |
    views:
      - title: Overview
        icon: mdi:train
        cards:
          - type: vertical-stack
            cards:
              # -----------------------------------
              #      NORTHBOUND (Manhattan/Qns)
              # -----------------------------------
              - type: custom:auto-entities
                card:
                  type: entities
                  title: Northbound (to Manhattan/Queens)
                  show_header_toggle: false
                filter:
                  template: |
                    [
                      {% set ns = namespace(rows=[]) %}
                      # --- ATLANTIC AV ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Atlantic Av-Barclays Ctr" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and ('Atlantic Av' in state.attributes.friendly_name or 'Barclays' in state.attributes.friendly_name) and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- BERGEN ST ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Bergen St" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and 'Bergen St' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St|Court Sq') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- FULTON ST ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Fulton St" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and 'Fulton St' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St|Court Sq') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- LAFAYETTE AV ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Lafayette Av" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and 'Lafayette Av' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- 57 ST ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "57 St-7 Av" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and '57 St' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
                      
                      {% for row in ns.rows %}
                        {{ row }},
                      {% endfor %}
                    ]
                # NO SORTING - keep the order we defined above (Station by Station)
                sort:
                  method: none
    
              # -----------------------------------
              #      SOUTHBOUND (Brooklyn)
              # -----------------------------------
              - type: custom:auto-entities
                card:
                  type: entities
                  title: Southbound (to Brooklyn)
                  show_header_toggle: false
                filter:
                  template: |
                    [
                      {% set ns = namespace(rows=[]) %}
                      # --- ATLANTIC AV ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Atlantic Av-Barclays Ctr" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and ('Atlantic Av' in state.attributes.friendly_name or 'Barclays' in state.attributes.friendly_name) and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- BERGEN ST ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Bergen St" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and 'Bergen St' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St|Court Sq') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- FULTON ST ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Fulton St" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and 'Fulton St' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St|Court Sq') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- LAFAYETTE AV ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "Lafayette Av" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and 'Lafayette Av' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
    
                      # --- 57 ST ---
                      {% set ns.rows = ns.rows + [{ "type": "section", "label": "57 St-7 Av" }] %}
                      {% for state in states.sensor -%}
                        {%- if state.attributes.friendly_name is defined and '57 St' in state.attributes.friendly_name and state.state not in ['unavailable', 'unknown'] -%}
                          {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                          {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                            {% set ns.rows = ns.rows + [{
                              "entity": state.entity_id,
                              "name": state.attributes.route_id ~ " to " ~ headsign,
                              "secondary_info": "last-updated"
                            }] %}
                          {%- endif -%}
                        {%- endif -%}
                      {%- endfor %}
                      
                      {% for row in ns.rows %}
                        {{ row }},
                      {% endfor %}
                    ]
                # NO SORTING - keep the order we defined above (Station by Station)
                sort:
                  method: none
    
      - title: Morning Commute
        icon: mdi:weather-sunset-up
        cards:
          - type: custom:auto-entities
            card:
              type: entities
              title: Morning Commute (Atlantic Av - N/Q/D)
              show_header_toggle: false
            filter:
              template: |
                [
                  {% for state in states.sensor -%}
                    {%- if state.attributes.friendly_name is defined and ('Atlantic Av' in state.attributes.friendly_name or 'Barclays' in state.attributes.friendly_name) and state.attributes.route_id in ['N', 'Q', 'D'] and state.state not in ['unavailable', 'unknown'] -%}
                      {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                      {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                      {
                        "entity": "{{ state.entity_id }}",
                        "name": "{{ state.attributes.route_id }} to {{ headsign }}",
                        "secondary_info": "last-updated"
                      },
                      {%- endif -%}
                    {%- endif -%}
                  {%- endfor %}
                ]
            sort:
              method: state
              numeric: true
    
      - title: Evening Commute
        icon: mdi:weather-night
        cards:
          - type: custom:auto-entities
            card:
              type: entities
              title: Evening Commute (57 St - N/Q/R/W)
              show_header_toggle: false
            filter:
              template: |
                [
                  {% for state in states.sensor -%}
                    {%- if state.attributes.friendly_name is defined and '57 St' in state.attributes.friendly_name and state.attributes.route_id in ['N', 'Q', 'R', 'W'] and state.state not in ['unavailable', 'unknown'] -%}
                      {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                      {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                      {
                        "entity": "{{ state.entity_id }}",
                        "name": "{{ state.attributes.route_id }} to {{ headsign }}",
                        "secondary_info": "last-updated"
                      },
                      {%- endif -%}
                    {%- endif -%}
                  {%- endfor %}
                ]
            sort:
              method: state
              numeric: true
    
      - title: Dynamic
        icon: mdi:map-marker-radius
        cards:
          - type: conditional
            conditions:
              - entity: device_tracker.pixel_9_pro_xl
                state_not: "work"
            card:
              type: custom:auto-entities
              card:
                type: entities
                title: To Work (Atlantic Av - N/Q/D)
                icon: mdi:briefcase
                show_header_toggle: false
              filter:
                template: |
                  [
                    {% for state in states.sensor -%}
                      {%- if state.attributes.friendly_name is defined and ('Atlantic Av' in state.attributes.friendly_name or 'Barclays' in state.attributes.friendly_name) and state.attributes.route_id in ['N', 'Q', 'D'] and state.state not in ['unavailable', 'unknown'] -%}
                        {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                        {%- if headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                        {
                          "entity": "{{ state.entity_id }}",
                          "name": "{{ state.attributes.route_id }} to {{ headsign }}",
                          "secondary_info": "last-updated"
                        },
                        {%- endif -%}
                      {%- endif -%}
                    {%- endfor %}
                  ]
              sort:
                method: state
                numeric: true
    
          - type: conditional
            conditions:
              - entity: device_tracker.pixel_9_pro_xl
                state: "work"
            card:
              type: custom:auto-entities
              card:
                type: entities
                title: To Home (57 St - N/Q/R/W)
                icon: mdi:home
                show_header_toggle: false
              filter:
                template: |
                  [
                    {% for state in states.sensor -%}
                      {%- if state.attributes.friendly_name is defined and '57 St' in state.attributes.friendly_name and state.attributes.route_id in ['N', 'Q', 'R', 'W'] and state.state not in ['unavailable', 'unknown'] -%}
                        {%- set headsign = state.attributes.headsign | default('Unknown') -%}
                        {%- if not headsign is search('Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St') -%}
                        {
                          "entity": "{{ state.entity_id }}",
                          "name": "{{ state.attributes.route_id }} to {{ headsign }}",
                          "secondary_info": "last-updated"
                        },
                        {%- endif -%}
                      {%- endif -%}
                    {%- endfor %}
                  ]
              sort:
                method: state
                numeric: true
