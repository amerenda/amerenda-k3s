apiVersion: v1
kind: ConfigMap
metadata:
  name: homeassistant-automations
data:
  alex_camera_privacy_away.yaml: |
    alias: "Alex - Camera Privacy (Away)"
    mode: "restart"
    triggers:
      - trigger: "zone"
        entity_id: "person.alex_merenda"
        zone: "zone.home"
        event: "leave"
    actions:
      - action: "light.turn_on"
        target:
          entity_id:
            - "light.bedroom_status_led"
            - "light.living_room_status_led"
      - action: "switch.turn_off"
        target:
          entity_id:
            - "switch.bedroom_privacy_mode"
            - "switch.living_room_privacy_mode"
  alex_camera_privacy_home.yaml: |
    alias: "Alex - Camera Privacy (Home)"
    mode: "restart"
    triggers:
      - trigger: "zone"
        entity_id: "person.alex_merenda"
        zone: "zone.home"
        event: "enter"
    actions:
      - action: "light.turn_off"
        target:
          entity_id:
            - "light.bedroom_status_led"
            - "light.living_room_status_led"
      - action: "switch.turn_on"
        target:
          entity_id:
            - "switch.bedroom_privacy_mode"
            - "switch.living_room_privacy_mode"
  alex_cleanup_old_photos.yaml: |
    alias: "Alex - Cleanup Old Photos (30+ days)"
    mode: "single"
    triggers:
      - platform: "time"
        at: "02:00:00"
    conditions: []
    actions:
      - service: "shell_command.cleanup_old_photos"
        data: {}
  alex_reolink_human_detect_alert.yaml: |
    alias: "Alex - Reolink Human Alert (Away)"
    mode: "queued"
    triggers:
      - trigger: "state"
        entity_id:
          - "binary_sensor.living_room_person"
          - "binary_sensor.bedroom_person"
        from: "off"
        to: "on"
    conditions:
      - condition: "not"
        conditions:
          - condition: "state"
            entity_id: "person.alex_merenda"
            state: "home"
    variables:
      CAM_MAP: >
        {{
          {
            'binary_sensor.living_room_person':
              {'camera': 'camera.living_room_fluent','room':'Living Room','slug':'living_room'},
            'binary_sensor.bedroom_person':
              {'camera': 'camera.bedroom_fluent',    'room':'Bedroom',    'slug':'bedroom'}
          }
        }}
      cam: "{{ CAM_MAP[trigger.entity_id]['camera'] }}"
      room: "{{ CAM_MAP[trigger.entity_id]['room'] }}"
      slug: "{{ CAM_MAP[trigger.entity_id]['slug'] }}"
      timestamp: "{{ now().strftime('%Y%m%d_%H%M%S') }}"
      path: "/config/www/intruders/{{ slug }}_{{ timestamp }}.jpg"
      url: "/local/intruders/{{ slug }}_{{ timestamp }}.jpg"
    actions:
      - action: "camera.snapshot"
        target: { entity_id: "{{ cam }}" }
        data:
          filename: "{{ path }}"
      - action: "notify.mobile_app_pixel_9_pro_xl"
        data:
          title: "Human detected - {{ room }}"
          message: "{{ now().strftime('%-I:%M %p on %b %-d') }}"
          data:
            image: "{{ url }}"
            tag: "human-{{ slug }}"
            importance: "high"
            sticky: true
  alex_reolink_pet_detect_snapshot.yaml: |
    alias: "Alex - Reolink Pet Snapshot (Away)"
    mode: "queued"
    triggers:
      - trigger: "state"
        entity_id:
          - "binary_sensor.living_room_animal"
          - "binary_sensor.bedroom_animal"
        from: "off"
        to: "on"
    conditions:
      - condition: "not"
        conditions:
          - condition: "state"
            entity_id: "person.alex_merenda"
            state: "home"
    variables:
      CAM_MAP: >
        {{
          {
            'binary_sensor.living_room_animal':
              {'camera': 'camera.living_room_fluent', 'room':'Living Room','slug':'living_room'},
            'binary_sensor.bedroom_animal':
              {'camera': 'camera.bedroom_fluent',     'room':'Bedroom',    'slug':'bedroom'}
          }
        }}
      cam: "{{ CAM_MAP[trigger.entity_id]['camera'] }}"
      room: "{{ CAM_MAP[trigger.entity_id]['room'] }}"
      slug: "{{ CAM_MAP[trigger.entity_id]['slug'] }}"
      timestamp: "{{ now().strftime('%Y%m%d_%H%M%S') }}"
      path: "/config/www/pets/{{ slug }}_{{ timestamp }}.jpg"
      url: "/local/pets/{{ slug }}_{{ timestamp }}.jpg"
    actions:
      - action: "camera.snapshot"
        target: { entity_id: "{{ cam }}" }
        data:
          filename: "{{ path }}"
      - action: "input_text.set_value"
        target: { entity_id: "input_text.event_image_location" }
        data: { value: "{{ slug }}" }
      - action: "input_text.set_value"
        target: { entity_id: "input_text.event_image_timestamp" }
        data: { value: "{{ timestamp }}" }
      - action: "notify.mobile_app_pixel_9_pro_xl"
        data:
          title: "Pet detected - {{ room }}"
          message: "{{ now().strftime('%-I:%M %p on %b %-d') }}"
          data:
            image: "{{ url }}"
            tag: "pet-{{ slug }}"
            importance: "low"
            sticky: true
  sync_weekday_weekend_times.yaml: |
    # Automation to sync weekday/weekend start times when separate_weekday_weekend is toggled
    # This ensures that when separate_weekday_weekend is enabled, the weekday/weekend helpers
    # are initialized with the current value from the regular start time helper (or default if not set)
    # Only sets values if the weekday/weekend helpers don't already have values set
    
    - id: sync_bedroom_morning_weekday_weekend_times
      alias: "Sync Bedroom Morning Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bedroom_morning_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s1_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s1_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s1_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s1_weekday_start
                          data:
                            datetime: "06:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s1_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s1_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s1_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s1_weekend_start
                          data:
                            datetime: "06:00:00"
      mode: single
    
    - id: sync_bedroom_day_weekday_weekend_times
      alias: "Sync Bedroom Day Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bedroom_day_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s2_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s2_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s2_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s2_weekday_start
                          data:
                            datetime: "09:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s2_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s2_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s2_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s2_weekend_start
                          data:
                            datetime: "09:00:00"
      mode: single
    
    - id: sync_bedroom_evening_weekday_weekend_times
      alias: "Sync Bedroom Evening Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bedroom_evening_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s3_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s3_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s3_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s3_weekday_start
                          data:
                            datetime: "17:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s3_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s3_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s3_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s3_weekend_start
                          data:
                            datetime: "17:00:00"
      mode: single
    
    - id: sync_bedroom_night_weekday_weekend_times
      alias: "Sync Bedroom Night Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bedroom_night_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s4_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s4_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s4_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s4_weekday_start
                          data:
                            datetime: "22:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bedroom_s4_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bedroom_s4_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bedroom_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s4_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bedroom_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bedroom_s4_weekend_start
                          data:
                            datetime: "22:00:00"
      mode: single
    
    - id: sync_living_room_morning_weekday_weekend_times
      alias: "Sync Living Room Morning Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.living_room_morning_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s1_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s1_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s1_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s1_weekday_start
                          data:
                            datetime: "06:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s1_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s1_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s1_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s1_weekend_start
                          data:
                            datetime: "06:00:00"
      mode: single
    
    - id: sync_living_room_day_weekday_weekend_times
      alias: "Sync Living Room Day Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.living_room_day_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s2_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s2_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s2_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s2_weekday_start
                          data:
                            datetime: "09:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s2_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s2_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s2_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s2_weekend_start
                          data:
                            datetime: "09:00:00"
      mode: single
    
    - id: sync_living_room_evening_weekday_weekend_times
      alias: "Sync Living Room Evening Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.living_room_evening_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s3_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s3_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s3_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s3_weekday_start
                          data:
                            datetime: "17:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s3_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s3_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s3_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s3_weekend_start
                          data:
                            datetime: "17:00:00"
      mode: single
    
    - id: sync_living_room_night_weekday_weekend_times
      alias: "Sync Living Room Night Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.living_room_night_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s4_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s4_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s4_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s4_weekday_start
                          data:
                            datetime: "22:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.living_room_s4_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.living_room_s4_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.living_room_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s4_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.living_room_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.living_room_s4_weekend_start
                          data:
                            datetime: "22:00:00"
      mode: single
    
    - id: sync_kitchen_morning_weekday_weekend_times
      alias: "Sync Kitchen Morning Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.kitchen_morning_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s1_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s1_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s1_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s1_weekday_start
                          data:
                            datetime: "06:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s1_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s1_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s1_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s1_weekend_start
                          data:
                            datetime: "06:00:00"
      mode: single
    
    - id: sync_kitchen_day_weekday_weekend_times
      alias: "Sync Kitchen Day Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.kitchen_day_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s2_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s2_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s2_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s2_weekday_start
                          data:
                            datetime: "09:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s2_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s2_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s2_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s2_weekend_start
                          data:
                            datetime: "09:00:00"
      mode: single
    
    - id: sync_kitchen_evening_weekday_weekend_times
      alias: "Sync Kitchen Evening Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.kitchen_evening_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s3_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s3_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s3_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s3_weekday_start
                          data:
                            datetime: "17:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s3_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s3_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s3_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s3_weekend_start
                          data:
                            datetime: "17:00:00"
      mode: single
    
    - id: sync_kitchen_night_weekday_weekend_times
      alias: "Sync Kitchen Night Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.kitchen_night_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s4_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s4_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s4_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s4_weekday_start
                          data:
                            datetime: "22:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.kitchen_s4_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.kitchen_s4_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.kitchen_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s4_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.kitchen_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.kitchen_s4_weekend_start
                          data:
                            datetime: "22:00:00"
      mode: single
    
    - id: sync_bathroom_morning_weekday_weekend_times
      alias: "Sync Bathroom Morning Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bathroom_morning_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s1_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s1_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s1_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s1_weekday_start
                          data:
                            datetime: "06:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s1_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s1_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s1_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s1_weekend_start
                          data:
                            datetime: "06:00:00"
      mode: single
    
    - id: sync_bathroom_day_weekday_weekend_times
      alias: "Sync Bathroom Day Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bathroom_day_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s2_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s2_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s2_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s2_weekday_start
                          data:
                            datetime: "09:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s2_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s2_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s2_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s2_weekend_start
                          data:
                            datetime: "09:00:00"
      mode: single
    
    - id: sync_bathroom_evening_weekday_weekend_times
      alias: "Sync Bathroom Evening Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bathroom_evening_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s3_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s3_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s3_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s3_weekday_start
                          data:
                            datetime: "17:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s3_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s3_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s3_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s3_weekend_start
                          data:
                            datetime: "17:00:00"
      mode: single
    
    - id: sync_bathroom_night_weekday_weekend_times
      alias: "Sync Bathroom Night Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.bathroom_night_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s4_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s4_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s4_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s4_weekday_start
                          data:
                            datetime: "22:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.bathroom_s4_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.bathroom_s4_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.bathroom_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s4_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.bathroom_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.bathroom_s4_weekend_start
                          data:
                            datetime: "22:00:00"
      mode: single
    
    - id: sync_hallway_morning_weekday_weekend_times
      alias: "Sync Hallway Morning Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.hallway_morning_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s1_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s1_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s1_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s1_weekday_start
                          data:
                            datetime: "06:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s1_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s1_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s1_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s1_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s1_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s1_weekend_start
                          data:
                            datetime: "06:00:00"
      mode: single
    
    - id: sync_hallway_day_weekday_weekend_times
      alias: "Sync Hallway Day Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.hallway_day_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s2_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s2_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s2_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s2_weekday_start
                          data:
                            datetime: "09:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s2_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s2_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s2_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s2_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s2_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s2_weekend_start
                          data:
                            datetime: "09:00:00"
      mode: single
    
    - id: sync_hallway_evening_weekday_weekend_times
      alias: "Sync Hallway Evening Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.hallway_evening_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s3_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s3_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s3_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s3_weekday_start
                          data:
                            datetime: "17:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s3_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s3_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s3_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s3_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s3_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s3_weekend_start
                          data:
                            datetime: "17:00:00"
      mode: single
    
    - id: sync_hallway_night_weekday_weekend_times
      alias: "Sync Hallway Night Weekday/Weekend Times"
      description: "When separate_weekday_weekend is toggled on, initialize weekday/weekend helpers if they don't have values"
      trigger:
        - platform: state
          entity_id: input_boolean.hallway_night_separate_weekday_weekend
          to: "on"
      action:
        - choose:
            # If weekday helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s4_weekday_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s4_weekday_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s4_weekday_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s4_weekday_start
                          data:
                            datetime: "22:00:00"
            # If weekend helper doesn't have a value, set it
            - conditions:
                - condition: or
                  conditions:
                    - condition: state
                      entity_id: input_datetime.hallway_s4_weekend_start
                      state: unknown
                    - condition: state
                      entity_id: input_datetime.hallway_s4_weekend_start
                      state: unavailable
              sequence:
                - choose:
                    # Use regular start time if it has a value, otherwise use default
                    - conditions:
                        - condition: and
                          conditions:
                            - condition: state
                              entity_id: input_datetime.hallway_s4_start
                              state: not
                                - unknown
                                - unavailable
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s4_weekend_start
                          data:
                            datetime: "{{ states('input_datetime.hallway_s4_start') }}"
                    - conditions: []
                      sequence:
                        - service: input_datetime.set_datetime
                          target:
                            entity_id: input_datetime.hallway_s4_weekend_start
                          data:
                            datetime: "22:00:00"
      mode: single
    
