views:
  - title: Overview
    icon: mdi:train
    cards:
      - type: vertical-stack
        cards:
          # --- ATLANTIC AV ---
          - type: custom:auto-entities
            card:
              type: entities
              title: Atlantic Av-Barclays Ctr
              show_header_toggle: false
            filter:
              include:
                - domain: sensor
                  attributes:
                    friendly_name: "/Atlantic Av|Barclays/"
                    headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St/"
                  options:
                    name: "Northbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
                - domain: sensor
                  attributes:
                    friendly_name: "/Atlantic Av|Barclays/"
                    headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St/"
                  options:
                    name: "Southbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
                - domain: sensor
                  attributes:
                    friendly_name: "/Atlantic Av|Barclays/"
                  options:
                    name: "Other: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          # --- BERGEN ST ---
          - type: custom:auto-entities
            card:
              type: entities
              title: Bergen St
              show_header_toggle: false
            filter:
              include:
                - domain: sensor
                  attributes:
                    friendly_name: "/Bergen St/"
                    headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St|Court Sq/"
                  options:
                    name: "Northbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
                - domain: sensor
                  attributes:
                    friendly_name: "/Bergen St/"
                    headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St|Church/"
                  options:
                    name: "Southbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          # --- FULTON ST ---
          - type: custom:auto-entities
            card:
              type: entities
              title: Fulton St
              show_header_toggle: false
            filter:
              include:
                - domain: sensor
                  attributes:
                    friendly_name: "/Fulton St/"
                    headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St|Court Sq/"
                  options:
                    name: "Northbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
                - domain: sensor
                  attributes:
                    friendly_name: "/Fulton St/"
                    headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St|Church/"
                  options:
                    name: "Southbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          # --- LAFAYETTE AV ---
          - type: custom:auto-entities
            card:
              type: entities
              title: Lafayette Av
              show_header_toggle: false
            filter:
              include:
                - domain: sensor
                  attributes:
                    friendly_name: "/Lafayette Av/"
                    headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St/"
                  options:
                    name: "Northbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
                - domain: sensor
                  attributes:
                    friendly_name: "/Lafayette Av/"
                    headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St|Euclid/"
                  options:
                    name: "Southbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          # --- 57 ST ---
          - type: custom:auto-entities
            card:
              type: entities
              title: 57 St-7 Av
              show_header_toggle: false
            filter:
              include:
                - domain: sensor
                  attributes:
                    friendly_name: "/57 St/"
                    headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St/"
                  options:
                    name: "Northbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
                - domain: sensor
                  attributes:
                    friendly_name: "/57 St/"
                    headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St/"
                  options:
                    name: "Southbound: [[ attribute.route_id ]] to [[ attribute.headsign ]]"
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

  - title: Morning Commute
    icon: mdi:weather-sunset-up
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Morning Commute (Atlantic Av Northbound)
          show_header_toggle: false
        filter:
          include:
            - domain: sensor
              attributes:
                # Regex friendly_name for Atlantic Av
                friendly_name: "/Atlantic Av|Barclays/"
                # Only N, Q, D lines
                route_id: ["N", "Q", "D"]
                # Northbound destinations
                headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St/"
              options:
                secondary_info: "[[ attribute.headsign ]]"
          exclude:
            - state: "unavailable"
            - state: "unknown"
        sort:
          method: state
          numeric: true

  - title: Evening Commute
    icon: mdi:weather-night
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Evening Commute (57 St Southbound)
          show_header_toggle: false
        filter:
          include:
            - domain: sensor
              attributes:
                # Regex friendly_name for 57 St
                friendly_name: "/57 St/"
                # Only N, Q, R, W lines
                route_id: ["N", "Q", "R", "W"]
                # Southbound destinations
                headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St/"
              options:
                secondary_info: "[[ attribute.headsign ]]"
          exclude:
            - state: "unavailable"
            - state: "unknown"
        sort:
          method: state
          numeric: true

  - title: Dynamic
    icon: mdi:map-marker-radius
    cards:
      - type: conditional
        conditions:
          - entity: device_tracker.pixel_9_pro_xl
            state_not: "work"
        card:
          type: custom:auto-entities
          card:
            type: entities
            title: To Work (Atlantic Av -> Manhattan)
            icon: mdi:briefcase
            show_header_toggle: false
          filter:
            include:
              - domain: sensor
                attributes:
                  friendly_name: "/Atlantic Av|Barclays/"
                  route_id: ["N", "Q", "D"]
                  headsign: "/Manhattan|Astoria|Forest Hills|Jamaica|96 St|205 St|Wakefield|Harlem|Ditmars|Midtown|Bedford|168 St|57 St/"
                options:
                  secondary_info: "[[ attribute.headsign ]]"
            exclude:
              - state: "unavailable"
              - state: "unknown"
          sort:
            method: state
            numeric: true

      - type: conditional
        conditions:
          - entity: device_tracker.pixel_9_pro_xl
            state: "work"
        card:
          type: custom:auto-entities
          card:
            type: entities
            title: To Home (57 St -> Brooklyn)
            icon: mdi:home
            show_header_toggle: false
          filter:
            include:
              - domain: sensor
                attributes:
                  friendly_name: "/57 St/"
                  route_id: ["N", "Q", "R", "W"]
                  headsign: "/Brooklyn|Coney Island|Brighton|Bay Ridge|Utica|New Lots|Flatbush|Far Rockaway|Stillwell|Church|Kings Hwy|Whitehall|95 St/"
                options:
                  secondary_info: "[[ attribute.headsign ]]"
            exclude:
              - state: "unavailable"
              - state: "unknown"
          sort:
            method: state
            numeric: true
