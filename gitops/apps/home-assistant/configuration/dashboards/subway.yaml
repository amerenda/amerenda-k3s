views:
  - title: Overview
    icon: mdi:train
    cards:
      - type: vertical-stack
        cards:
          - type: custom:auto-entities
            card:
              type: entities
              title: Atlantic Av-Barclays Ctr
              show_header_toggle: false
            filter:
              include:
                - attributes:
                    friendly_name: "Atlantic Av*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id
              
          - type: custom:auto-entities
            card:
              type: entities
              title: Bergen St
              show_header_toggle: false
            filter:
              include:
                - attributes:
                    friendly_name: "Bergen St*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: Fulton St
              show_header_toggle: false
            filter:
              include:
                - attributes:
                    friendly_name: "Fulton St*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: Lafayette Av
              show_header_toggle: false
            filter:
              include:
                - attributes:
                    friendly_name: "Lafayette Av*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: 57 St-7 Av
              show_header_toggle: false
            filter:
              include:
                - attributes:
                    friendly_name: "57 St*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

  - title: Morning Commute
    icon: mdi:weather-sunset-up
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Morning Commute (Northbound)
          show_header_toggle: false
        filter:
          include:
            # Atlantic Av - Northbound (N/Q/D)
            # Logic: Match station AND route AND typically Northbound destinations
            - domain: sensor
              attributes:
                friendly_name: "Atlantic Av*"
                route_id: ["N", "Q", "D"]
                # Common Northbound/Manhattan/Queens/Bronx terminals
                headsign: ["Astoria*", "96 St*", "Manhattan*", "Midtown*", "205 St*", "Bedford*", "168 St*", "Jamaica*", "57 St*", "Forest Hills*", "Ditmars*"]
              options:
                secondary_info: "[[ attribute.headsign ]]"
          exclude:
            - state: "unavailable"
            - state: "unknown"
        sort:
          method: state
          numeric: true

  - title: Evening Commute
    icon: mdi:weather-night
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Evening Commute (Southbound)
          show_header_toggle: false
        filter:
          include:
            # 57 St - Southbound (N/Q/R/W)
            - domain: sensor
              attributes:
                friendly_name: "57 St*"
                route_id: ["N", "Q", "R", "W"]
                # Common Southbound/Brooklyn terminals
                headsign: ["Coney Island*", "Brighton Beach*", "Sea Beach*", "Bay Ridge*", "Whitehall*", "95 St*", "Stillwell*", "Church*", "Kings Hwy*"]
              options:
                secondary_info: "[[ attribute.headsign ]]"
          exclude:
            - state: "unavailable"
            - state: "unknown"
        sort:
          method: state
          numeric: true

  - title: Dynamic
    icon: mdi:map-marker-radius
    cards:
      # Show Morning Commute if NOT at Work (e.g. Home or Away)
      - type: conditional
        conditions:
          - entity: device_tracker.pixel_9_pro_xl
            state_not: "work"
        card:
          type: custom:auto-entities
          card:
            type: entities
            title: To Work (Atlantic Av -> Manhattan)
            icon: mdi:briefcase
            show_header_toggle: false
          filter:
            include:
              - domain: sensor
                attributes:
                  friendly_name: "Atlantic Av*"
                  route_id: ["N", "Q", "D"]
                  headsign: ["Astoria*", "96 St*", "Manhattan*", "Midtown*", "205 St*", "Bedford*", "168 St*", "Jamaica*", "57 St*", "Forest Hills*", "Ditmars*"]
                options:
                  secondary_info: "[[ attribute.headsign ]]"
            sort:
              method: state
              numeric: true

      # Show Evening Commute if AT Work
      - type: conditional
        conditions:
          - entity: device_tracker.pixel_9_pro_xl
            state: "work"
        card:
          type: custom:auto-entities
          card:
            type: entities
            title: To Home (57 St -> Brooklyn)
            icon: mdi:home
            show_header_toggle: false
          filter:
            include:
              - domain: sensor
                attributes:
                  friendly_name: "57 St*"
                  route_id: ["N", "Q", "R", "W"]
                  headsign: ["Coney Island*", "Brighton Beach*", "Sea Beach*", "Bay Ridge*", "Whitehall*", "95 St*", "Stillwell*", "Church*", "Kings Hwy*"]
                options:
                  secondary_info: "[[ attribute.headsign ]]"
            sort:
              method: state
              numeric: true

