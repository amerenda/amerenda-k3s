views:
  - title: Overview
    icon: mdi:train
    cards:
      - type: vertical-stack
        cards:
          - type: custom:auto-entities
            card:
              type: entities
              title: Atlantic Av-Barclays Ctr
              show_header_toggle: false
            filter:
              include:
                - entity_id: "sensor.*atlantic_av*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: Bergen St
              show_header_toggle: false
            filter:
              include:
                - entity_id: "sensor.*bergen_st*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: Fulton St
              show_header_toggle: false
            filter:
              include:
                - entity_id: "sensor.*fulton_st*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: Lafayette Av
              show_header_toggle: false
            filter:
              include:
                - entity_id: "sensor.*lafayette_av*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

          - type: custom:auto-entities
            card:
              type: entities
              title: 57 St-7 Av
              show_header_toggle: false
            filter:
              include:
                - entity_id: "sensor.*57_st*"
                  options:
                    secondary_info: last-updated
              exclude:
                - state: "unavailable"
                - state: "unknown"
            sort:
              method: attribute
              attribute: route_id

  - title: Morning Commute
    icon: mdi:weather-sunset-up
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Morning Commute (Northbound)
          show_header_toggle: false
        filter:
          include:
            - domain: sensor
              entity_id: "*atlantic_av*"
              attributes:
                route_id: ["N", "Q", "D"]
                headsign: ["Astoria*", "96 St*", "Manhattan*", "Midtown*", "205 St*", "Bedford*", "168 St*", "Jamaica*", "57 St*", "Forest Hills*", "Ditmars*"]
              options:
                secondary_info: "[[ attribute.headsign ]]"
          exclude:
            - state: "unavailable"
            - state: "unknown"
        sort:
          method: state
          numeric: true

  - title: Evening Commute
    icon: mdi:weather-night
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Evening Commute (Southbound)
          show_header_toggle: false
        filter:
          template: |
            [
              {% for state in states.sensor -%}
                {%- if '57_st' in state.entity_id and state.attributes.route_id in ['N', 'Q', 'R', 'W'] and state.state not in ['unavailable', 'unknown'] -%}
                  {
                    "entity": "{{ state.entity_id }}",
                    "secondary_info": "{{ state.attributes.headsign }}"
                  },
                {%- endif -%}
              {%- endfor %}
            ]
        sort:
          method: state
          numeric: true

  - title: Dynamic
    icon: mdi:map-marker-radius
    cards:
      - type: conditional
        conditions:
          - entity: device_tracker.pixel_9_pro_xl
            state_not: "work"
        card:
          type: custom:auto-entities
          card:
            type: entities
            title: To Work (Atlantic Av -> Manhattan)
            icon: mdi:briefcase
            show_header_toggle: false
          filter:
            include:
              - entity_id: "sensor.*atlantic_av*"
                attributes:
                  route_id: ["N", "Q", "D"]
                  headsign: ["Astoria*", "96 St*", "Manhattan*", "Midtown*", "205 St*", "Bedford*", "168 St*", "Jamaica*", "57 St*", "Forest Hills*", "Ditmars*"]
                options:
                  secondary_info: "[[ attribute.headsign ]]"
            exclude:
              - state: "unavailable"
              - state: "unknown"
          sort:
            method: state
            numeric: true

      - type: conditional
        conditions:
          - entity: device_tracker.pixel_9_pro_xl
            state: "work"
        card:
          type: custom:auto-entities
          card:
            type: entities
            title: To Home (57 St -> Brooklyn)
            icon: mdi:home
            show_header_toggle: false
          filter:
            include:
              - entity_id: "sensor.*57_st*"
                attributes:
                  route_id: ["N", "Q", "R", "W"]
                  headsign: ["Coney Island*", "Brighton Beach*", "Sea Beach*", "Bay Ridge*", "Whitehall*", "95 St*", "Stillwell*", "Church*", "Kings Hwy*"]
                options:
                  secondary_info: "[[ attribute.headsign ]]"
            exclude:
              - state: "unavailable"
              - state: "unknown"
          sort:
            method: state
            numeric: true
