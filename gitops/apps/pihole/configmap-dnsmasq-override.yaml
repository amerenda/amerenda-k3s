---
# Custom dnsmasq configuration to disable stale cache serving
# This ensures expired cache entries are not served, forcing fresh queries
apiVersion: v1
kind: ConfigMap
metadata:
  name: pihole-dnsmasq-override
  namespace: pihole
  annotations:
    argocd.argoproj.io/sync-wave: "0"
data:
  # This file will override the use-stale-cache setting from the main dnsmasq.conf
  # Files in /etc/dnsmasq.d/ are loaded after the main config, so this will override
  99-disable-stale-cache.conf: |
    # Disable serving stale cache entries
    # This forces dnsmasq to query upstream instead of serving expired cache
    use-stale-cache=0

