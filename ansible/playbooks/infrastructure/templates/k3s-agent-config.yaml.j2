# k3s Agent Configuration
# Generated by Ansible for {{ inventory_hostname }}

# Server connection
server: "https://{{ k3s_server_ip }}:6443"
token: "{{ k3s_token | default(ansible_env.K3S_TOKEN) }}"

# Node configuration
node-name: "{{ inventory_hostname }}"
node-ip: "{{ ansible_host }}"

# Data directory
data-dir: "/var/lib/rancher/k3s"

# Logging
log: "/var/log/k3s-agent.log"

# Kubelet configuration for Longhorn-only node
kubelet-arg:
  - "max-pods=110"
  - "kube-reserved=cpu=100m,memory=256Mi"
  - "system-reserved=cpu=100m,memory=256Mi"
  - "eviction-hard=memory.available<100Mi"
  - "eviction-soft=memory.available<200Mi"
  - "eviction-soft-grace-period=memory.available=2m"

# Node labels for Longhorn
node-label:
  - "longhorn.io/storage=true"
  - "node-role.kubernetes.io/longhorn-storage=true"
